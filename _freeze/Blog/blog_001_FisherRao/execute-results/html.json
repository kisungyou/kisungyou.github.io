{
  "hash": "f3435a683892c23ca1a04f4a7fc089cf",
  "result": {
    "markdown": "---\npagetitle: \"KY-Blog\"\ntitle: \"What is Fisher-Rao distance?\"\nimage: images/figure_001_FisherRao.png\ndate: 2025-02-05\ncategories:\n  - What is?\nformat: \n  html:\n    df-print: paged\n    toc: true\nengine: knitr\ncitation: true\ncomments: false\nbibliography: biball.bib\nbiblio-style: plain\ngoogle-scholar: false\nnumber-sections: false\nauthor:\n  - name: Kisung You\n    url: https://kisungyou.com\n    affiliation: Baruch College\n---\n\n\n## Introduction\n\nHow can we measure the difference between two probability distributions in a principled way? One approach is through the **Fisher-Rao distance**, a geometric measure of dissimilarity based on the **Fisher information matrix** (FIM).\n\nTo understand this distance, we first examine the role of the FIM in statistical inference and its interpretation as a Riemannian metric. This metric structure naturally leads to the Fisher-Rao distance, which measures the shortest path—or geodesic—between distributions on the statistical manifold. However, directly computing this distance is often intractable.\n\nTo address this challenge, we introduce an alternative approach: the square-root transformation, which embeds probability densities into a Hilbert space. A key result follows from this transformation: the Fisher-Rao distance is exactly twice the geodesic distance between transformed densities on the unit sphere. This connection not only simplifies computations but also offers new insights into the geometry of probability distributions.\n\n\n\n## Fisher Information Matrix\n\nIn a standard mathematical statistics course, one encounters the **Fisher information matrix (FIM)** for a probability density function $p(x\\vert \\theta)$ with some parameter $\\theta \\in \\Theta \\subset \\mathbb{R}^d$, defined as:\n\\begin{equation*}\nI(\\theta) = \\mathbb{E} \\left[\n\\left( \\frac{\\partial}{\\partial \\theta} \\log p(x\\vert \\theta) \\right) \\left( \\frac{\\partial}{\\partial \\theta} \\log p(x\\vert \\theta) \\right)^\\top\n\\right].\n\\end{equation*}\nAlternatively, it can be expressed in terms of second derivatives:\n\\begin{equation*}\nI(\\theta) = -\\mathbb{E} \\left[\\frac{\\partial^2 \\log p(x\\vert \\theta)}{\\partial \\theta \\partial \\theta^\\top}\\right].\n\\end{equation*}\n\nThe Fisher information matrix plays a central role in statistical inference. In **maximum likelihood estimation (MLE)**, it helps assess the asymptotic variance of the MLE:\n\\begin{equation}\n\\sqrt{n} (\\hat{\\theta}_n - \\theta) \\xrightarrow{d} \\mathcal{N}(0, I^{-1}(\\theta)).\n\\end{equation}\nThe **Cramér-Rao bound** states that for any unbiased estimator $\\hat{\\theta}$:\n\\begin{equation}\n\\textrm{Cov}(\\hat{\\theta}) \\succeq I^{-1}(\\theta),\n\\end{equation}\nwhere $A \\succeq B$ indicates that $A-B$ is positive semi-definite. In other words, the covariance matrix of any unbiased estimator is bounded below by the inverse of the FIM. In **Bayesian statistics**, the FIM is related to constructing priors[^1]. The Jeffreys prior, an invariant and non-informative prior, is given by:\n\\begin{equation}\n\\pi(\\theta) \\propto \\sqrt{\\textrm{det}(I(\\theta))},\n\\end{equation}\nwhich is an objective, non-information prior that is invariant under reparametrization.\n\n## Fisher-Rao Metric\n\nA key discovery in **information geometry** [@amari_2007_MethodsInformationGeometry] is that the FIM induces a [Riemannian metric](https://en.wikipedia.org/wiki/Riemannian_manifold#Riemannian_metrics_and_Riemannian_manifolds) on the statistical manifold $\\mathcal{M} = \\lbrace p(x\\vert \\theta) \\rbrace$, known as the **Fisher-Rao metric**. Given an infinitesimal displacement $d\\theta$ in the parameter space $\\Theta$, the squared _length_ of the displacement under the Fisher-Rao metric is given by:\n\\begin{equation}\nds^2 = d\\theta^\\top I(\\theta) d\\theta.\n\\end{equation}\nThus, the Fisher-Rao metric captures the local geometry of the statistical manifold by taking the FIM as the local matrix form in a given coordinate system.\n\n## Fisher-Rao Distance\n\nSince the Fisher-Rao metric defines a Riemannian structure, one can define a distance between two points in the manifold. The **Fisher-Rao distance** between two distributions, $p_1(x) = p(x\\vert \\theta_1)$ and $p_2(x) = p(x\\vert \\theta_2)$, is the geodesic length connecting $\\theta_1$ and $\\theta_2$:\n\n$$\nd_{FR}(p_1, p_2):= d_{FR}(\\theta_1, \\theta_2) = \\underset{\\gamma}{\\inf} \\int \\sqrt{\\dot{\\gamma}(t)^\\top I(\\gamma(t)) \\dot{\\gamma}(t)} dt,\n$$ {#eq-DefFisherRaoDistance}\nwhere the infimum is taken over all smooth curves $\\gamma:[0,1] \\rightarrow \\Theta$ such that $\\gamma (0) = \\theta_1$ and $\\gamma (1) = \\theta_2$. This formulation reveals that the Fisher-Rao distance is a Riemannian geodesic distance.\n\n\n\n## Computing the Fisher-Rao Distance\n\nWhile theoretically elegant, computing the Fisher-Rao distance as in @eq-DefFisherRaoDistance is challenging because it requires solving the geodesic equations:\n$$\n\\frac{d^2 \\theta^i}{dt^2} + \\sum_{j,k} \\Gamma^i_{jk} \\frac{d\\theta^j}{dt} \\frac{d\\theta^k}{dt} = 0,\n$$\nwhere $\\Gamma^i_{jk}$ are Christoffel symbols derived from the Fisher information metric:\n$$\n\\Gamma^i_{jk} = \\frac{1}{2} \\sum_m I^{im} \\left( \\frac{\\partial I_{mj}}{\\partial \\theta^k} + \\frac{\\partial I_{mk}}{\\partial \\theta^j} - \\frac{\\partial I_{jk}}{\\partial \\theta^m} \\right).\n$$\nExact solutions are known to exist for only a handful of distributions [@miyamoto_2024_ClosedFormExpressionsFisherRao].\n\n\n\n## Square-Root Transformation and Geodesic Distance\n\nA practical alternative for computing the Fisher-Rao distance is the **square-root transformation**:\n$$\np(x) \\mapsto \\sqrt{p(x)}.\n$$\nThis procedure embeds probability densities into the Hilbert space $L_2$ with the standard inner product. For $f,g \\in L_2$, the inner product is given by\n$$\n\\langle f,g \\rangle = \\int f(x) g(x) dx.\n$$\n\nIt is straightforward to verify that the transformed functions lie on the infinite-dimensional unit sphere $S^\\infty$. Specifically, let $f \\in L_2$ be the transformed function of some density $\\phi$, i.e., $f(x) = \\sqrt{\\phi(x)}$. Then, we have\n$$\n\\| f \\|^2 = \\langle f, f \\rangle = \\int f(x)^2 dx = \\int \\phi(x) = 1,\n$$\nwhere the last equality follows from the fact that $\\phi(x)$ is a probability density function and thus integrates to 1.\n\nOn the unit sphere in $L^2$, the geodesic curve between two points is given by the great circle connecting them. Let $\\psi_1$ and $\\psi_2$ be two elements of $S^\\infty$. Then, the geodesic distance between them is canonically known by $\\textrm{arccos}(\\langle \\psi_1, \\psi_2 \\rangle)$.\n\n\n## Equivalence of Fisher-Rao Distance and Geodesic Distance of Square Root Densities\n\nWe are now ready to state the main result of this discussion. The Fisher-Rao distance between two distributions, $p_1(x) = p(x\\vert \\theta_1)$ and $p_2(x) = p(x\\vert \\theta_2)$, is twice the geodesic distance between their square-root transformed densities, $\\psi_1(x) = \\sqrt{p_1(x)}$ and $\\psi_2(x) = \\sqrt{p_2(x)}$, on $S^\\infty$:\n\n> $$d_{FR}(p_1,p_2) = 2 \\textrm{arccos} \\left(\n\\int \\sqrt{p_1 (x) p_2(x)} dx \n\\right)$$ {#eq-equivalence}\n\nTo verify @eq-equivalence, consider an infinitesimal perturbation in $p(x)$ by introducing a small variation:\n$$\np(x) \\mapsto p(x) + \\epsilon h(x),\n$$ {#eq-mapped}\nwhere $h(x)$ is an arbitrary function that integrates to 0 and $\\epsilon > 0$. This constraint ensures that $p(x) + \\epsilon h(x)$ remains as a valid density. Our goal is to quantify how this small variation in $p(x)$ induces a corresponding change in $\\psi(x)$. In other words, we seek to measure the variation in the transformed function. Viewing the right-hand side of @eq-mapped as a function of $\\epsilon$, we apply a first-order Taylor expansion to the square-root transformation:\n$$\n\\sqrt{p + \\epsilon h} \\approx \\sqrt{p} + \\frac{1}{2} \\frac{\\epsilon h}{\\sqrt{p}} + O(\\epsilon^2).\n$$\nThus, the infinitesimal perturbation in $\\psi(x)$ is:\n$$\n\\delta \\psi(x) = \\sqrt{p(x) + \\epsilon h(x)} - \\sqrt{p(x)}\n = \\frac{1}{2}\\frac{h(x)}{\\sqrt{p(x)}} \\epsilon + O(\\epsilon^2).\n$$ {#eq-infinitesimal}\n\nFrom @eq-infinitesimal, we observe that $\\delta \\psi(x)$ is linear in $h(x)$, demonstrating how small changes in $p(x)$ translate to changes in $\\psi(x)$[^2]. Recall that the Fisher-Rao metric corresponds to infinitesimal displacements in probability space. Given the embedding of densities via the square-root transformation, it is natural to measure perturbations by computing the squared norm:\n$$\nds^2 = \\|\\delta \\psi \\|^2 = \\int \\left( \\frac{1}{2}\\frac{h(x)}{\\sqrt{p(x)}} \\right)^2 dx = \\frac{\\epsilon^2}{4} \\int \\frac{h(x)^2}{p(x)} dx.\n$$ {#eq-hellow}\n\nSince $h(x)$ represents an infinitesimal change in $p(x)$, we recognize that the integral in @eq-hellow corresponds precisely to the Fisher information metric evaluated for an infinitesimal displacement. Consequently, we obtain\n$$\nds^2 = \\frac{1}{4} \\int \\frac{h(x)^2}{p(x)} dx.\n$$\nwhich reveals that the Fisher-Rao metric is $\\frac{1}{4}$ times the standard metric on $S^\\infty$ induced by the square-root transformation.\n\nBy combining these observations with the fact that geodesic distances scale inversely with the metric factor, we conclude that the geodesic distance computed in the Fisher-Rao metric is twice the standard geodesic distance on the unit sphere in $L^2$. That is, for two densities $p_1$ and $p_2$ and their transformations $\\psi_1 = \\sqrt{p_1}$ and $\\psi_2 = \\sqrt{p_2}$ in $L_2$, we have\n$$\nd_{FR}(p_1, p_2) = 2 \\times d_{S^\\infty} (\\psi_1, \\psi_2) = 2 \\textrm{arccos} \\left( \\int\n\\sqrt{p_1 (x) p_2 (x)} dx\n\\right).\n$$\n\n\n## Final Thoughts {.unnumbered}\t\t\n\n1. In the derivation of the Fisher-Rao distance in terms of the scaled geodesic distance on $S^\\infty$, no specific choice or constraint is imposed on $\\theta$. This formulation naturally extends to nonparametric probability densities, as the geodesic distance in $L^2$ depends solely on the embedding.\n2. Despite the equivalence, some concerns remain regarding the computability of the Fisher-Rao distance. For instance, evaluating the integral can be challenging in many cases, particularly for high-dimensional distributions or arbitrary nonparametric densities, where numerical integration becomes intractable. Approximation via Monte Carlo methods, while useful, presents its own set of difficulties. Moreover, when densities are estimated, they may contain regions of extremely small values, leading to numerical precision issues.\n3. I would like to express my appreciation to Prof. [Marco Radeschi](https://sites.google.com/view/marco-radeschi) for his kindness and patience in enduring my endless questions in his differential geometry course - many of which, in hindsight, seem absurd.\n\n\n[^1]: There is an interesting connection to the objective Bayesian framework, which will appear in a later post.\n[^2]: From a geometric point of view, $\\delta \\psi(x)$ belongs to the tangent space of $S^\\infty$ at the point $\\psi(x)$.\n\n## References {.unnumbered .unlisted}\n\n::: {#refs}\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}