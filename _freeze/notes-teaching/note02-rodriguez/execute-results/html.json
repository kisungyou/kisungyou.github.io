{
  "hash": "ebfd8b34dc97fb48ab185e18917f7efe",
  "result": {
    "markdown": "---\ntitle: \"Rodrigues' formula for the Legendre polynomials\"\nformat: \n  html:\n    df-print: paged\n    toc: true\ndescription: \"Rodrigues' formula for the Legendre polynomials\"\ndate: 2022-08-10\nauthor: \"Kisung You\"\nengine: knitr\ncitation: true\ncomments: false\nbibliography: bibnote.bib\nbiblio-style: plain\ngoogle-scholar: true\nnumber-sections: false\npagetitle: \"KY-Teaching\"\n---\n\n\n## Introduction\n\nLegendre polynomials $P_n (x)$ are solutions of the following Legendre's differential equation\n$$\n(1-x^2) y'' - 2x y' + n(n+1) y = 0\n$$ {#eq-legendre}\nfor some $n \\in \\mathbb{N}\\cup \\{0\\}$. An explicit, compact expression for the polynomials is provided by Rodrigues' formula\n$$\nP_n (x) = \\frac{1}{2^n n!} \\frac{d^n}{dx^n} (x^2-1)^n.\n$$ {#eq-rodrigues}\n\nThis means that when $P_n (x)$ is plugged in the position of $y$ for @eq-legendre, it must satisfy the equality to 0. In this post, we show (a bit tedious) derivations to attain @eq-rodrigues.\n\n## Approach\n\nI will proceed in two steps. Let $f_n (x) = (x^2 - 1)^n$ then we first show that the $n$-th derivative of $f_n (x)$ is a solution of Legendre equation. Then, we find a proper scaling factor of $1/ 2^n n!$ to recover $P_n (x)$ in line with a common constraint that $P_n (x) = 1$ for all $n$ when $x=1$. For notational simplicity, we denote $g^{(n)}$ for the $n$-th derivative of a function $g(x)$, i.e,\n$$\ng^{(n)} = \\frac{d^n}{dx^n} g(x).\n$$\n\nBefore proceeding, we need (generalized) Leibniz's rule. Suppose we have $n$-times differentiable functions $f(x)$ and $g(x)$, then \n$$\n\\frac{d^n}{dx^n} f(x) g(x) = \\sum_{k=0}^n\n\\begin{pmatrix}\nn \\\\ k\n\\end{pmatrix}\nf^{(n-k)} (x) g^{(k)} (x) = \\sum_{k=0}^n \\frac{n!}{k! (n-k)!} f^{(n-k)} (x) g^{(k)} (x) \n$$ {#eq-leibniz}\nwhere the choice of $f$ and $g$ can help in reducing the number of terms when there exists a polynomial term. For example, when $g(x) = x^2$, $g^{(k)} = 0$ for all $k \\geq 3$. \n\n### Step 1. $f_n^{(n)} (x)$ is one solution.\n\n\nOur goal here is to show that $f_n^{(n)}(x)$ is a solution for @eq-legendre. As a first step, let's take derivative on $f_n (x)$,\n$$\n\\begin{align*}\n\\frac{d}{dx} f_n (x) &= 2 n (x^2  - 1)^{n-1} x \\\\\n&= 2nx (x^2 - 1)^{n-1}.\n\\end{align*}\n$$\nBy multiplying $(x^2 - 1)$ both side of the above, we have\n$$\n(x^2 - 1) \\frac{d}{dx} f_n (x)  = 2nx (x^2 - 1)^n.\n$$\n\nNow, differentiate both sides $(n+1)$ times, which leads to \n$$\n\\begin{align*}\n\\frac{d^{n+1}}{dx^{n+1}} \\left[ \\frac{d}{dx} f_n (x) \\right]  (x^2 -1) \n&= \\sum_{k=0}^{n+1}\n\\begin{pmatrix}\nn+1 \\\\ k\n\\end{pmatrix}\n\\left( \\frac{d}{dx} f_n (x) \\right)^{(n+1-k)} (x^2-1)^{(k)} \\\\\n&= \n\\begin{pmatrix}\nn+1 \\\\ 0\n\\end{pmatrix}\nf_n^{(n+2)} (x) (x^2-1) + \n\\begin{pmatrix}\nn+1 \\\\ 1\n\\end{pmatrix}\n2x f_n^{(n+1)}  (x) +\n\\begin{pmatrix}\nn+1 \\\\ 2\n\\end{pmatrix}\nf_n ^{(n)} (x) \\cdot 2 \\\\\n&= (x^2-1) f_n^{(n+2)} (x) + 2(n+1)x f_n^{(n+1)} (x) + \nn(n+1) f_n^{(n)} (x) \n\\end{align*}\n$$\nfor the left-hand side. We also have that \n$$\n\\begin{align*}\n\\frac{d^{n+1}}{dx^{n+1}} f_n(x) 2nx &=\n\\begin{pmatrix}\nn+1 \\\\ 0\n\\end{pmatrix} \nf_n^{(n+1)} (x) 2nx + \n\\begin{pmatrix}\nn+1 \\\\ 1\n\\end{pmatrix}\nf_n^{(n)} (x) 2n \\\\\n&= 2nx f_n^{(n+1)} (x) + 2n(n+1)f_n^{(n)}(x). \n\\end{align*}\n$$\nTherefore, we have the following arrangement,\n$$\n\\begin{equation*}\n\t\\begin{gathered}\n\t(x^2 - 1) f_n^{(n+2)} (x) + 2x(n+1)f_n^{(n+1)} (x) + n(n+1)f_n^{(n)} (x) = \n\t2nx f_n^{(n+1)} (x) + 2n(n+1) f_n^{(n)} (x) \\\\\n\t(x^2-1) f_n^{(n+2)} (x) + 2x f_n^{(n+1)}(x) - n(n+1)f_n^{(n)} (x) = 0 \\\\\n\t(1- x^2) f_n^{(n+2)} (x) - 2x f_n^{(n+1)}(x) + n(n+1)f_n^{(n)} (x) = 0\n\t\\end{gathered}\n\\end{equation*}\n$$\nwhere the last line is in the form of @eq-legendre so that we have $f_n^{(n)} (x)$ as a solution. \n\n### Step 2. Find a scaling factor.\n\nEven though $f_n^{(n)} (x)$ as a solution, we have a requirement for the standard Legendre polynomial that $P_n (x)=1$ for $x=1$. Let us take a closer look at $f_n^{(n)}(x)$ when evaluated at $x=1$.\n$$\n\\begin{align*}\nf_n^{(n)} (x) &= \\frac{d^n}{dx^n} (x^2-1)^n \\\\\n&= \\frac{d^n}{dx^n} (x+1)^n (x-1)^n \\\\\n&= \\sum_{k=0}^n \\begin{pmatrix}\nn \\\\ k\n\\end{pmatrix}\n\\left( (x+1)^n \\right)^{(k)} \\left( (x-1)^n \\right) ^{(n-k)} \\quad \\textrm{by the Leibniz's rule} \\\\\n&= \\sum_{k=0}^n \\begin{pmatrix}\nn \\\\ k\n\\end{pmatrix}\n\\frac{n!}{(n-k)!} (x+1)^{n-k} \\frac{n!}{k!} (x-1)^k \\qquad (*) \\\\\n&= n! \\sum_{k=0}^n \\begin{pmatrix}\nn \\\\ k\n\\end{pmatrix} \\frac{n!}{(n-k)! k!} (x+1)^{n-k} (x-1)^k \\\\\n&= n! \\sum_{k=0}^n \\begin{pmatrix}\nn \\\\ k\n\\end{pmatrix}^2 (x+1)^{n-k} (x-1)^k,\n\\end{align*}\n$$\nSince we want to evaluate $f_n^{(n)} (x)$ at $x=1$, the last line of equations above tells us that all the terms but $k=0$ become zero, \n$$\n\\begin{equation*}\nf_n^{(n)} (x=1) = n! \\begin{pmatrix}\nn \\\\ 0\n\\end{pmatrix}^2 2^{n-0} = n! 2^n\n\\end{equation*}\n$$\nwhich finally leads to define $P_n (x)$ as\n$$\nP_n (x) = \\frac{1}{n! 2^n}f_n^{(n)}(x)  = \\frac{1}{n! 2^n} \\frac{d^n}{dx^n} (x^2-1)^n\n$$\nto fulfill the condition of $P_n (x) =1$ for $x=1$. ",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}